# search-service

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Elasticsearch —á–µ—Ä–µ–∑ GraphQL.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –Ω–µ—á–µ—Ç–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ü–µ–Ω–µ, —Ä–∞–∑–º–µ—Ä—É, —Ü–≤–µ—Ç—É, –º–∞—Ç–µ—Ä–∏–∞–ª—É, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –±—Ä–µ–Ω–¥—É –∏ —Å–∫–ª–∞–¥—É
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üì° GraphQL API

### Query: `searchProducts`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.

–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤ go run github.com/99designs/gqlgen generate 

**–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`SearchInput`):**

input SearchInput {
  name: String
  description: String
  productID: Int
  variantID: Int
  sku: String
  material: String
  color: String
  size: String
  barcode: String
  dimensions: String

  minPrice: Float
  maxPrice: Float

  stock: Int

  categoryID: Int
  brandID: Int
  isActive: Boolean

  page: Int
  limit: Int
}

---

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

```graphql
query {
  searchProducts(input: {
    name: "—Ñ—É—Ç–±–æ–ª–∫–∞",
    minPrice: 500,
    maxPrice: 2000,
    page: 1,
    limit: 10
  }) {
    products {
      id
      name
      description
      categoryID
      brandID
      variants {
        variantID
        sku
        price
        sizes
        colors
        material
        stock
        rating
      }
    }
    total
    page
    limit
    pages
  }
}


{
  "data": {
    "searchProducts": {
      "products": [
        {
          "id": 1,
          "name": "–§—É—Ç–±–æ–ª–∫–∞ —Ö–ª–æ–ø–∫–æ–≤–∞—è",
          "description": "–ú—è–≥–∫–∞—è —Ö–ª–æ–ø–∫–æ–≤–∞—è —Ñ—É—Ç–±–æ–ª–∫–∞",
          "categoryID": 1,
          "brandID": 1,
          "variants": [
            {
              "variantID": "var_1",
              "sku": "T-SHIRT-001",
              "price": 1500.0,
              "sizes": [42, 44, 46],
              "colors": ["–±–µ–ª—ã–π", "—á–µ—Ä–Ω—ã–π"],
              "material": "—Ö–ª–æ–ø–æ–∫",
              "stock": 100,
              "rating": 4.5
            }
          ]
        }
      ],
      "total": 150,
      "page": 1,
      "limit": 20,
      "pages": 8
    }
  }
}


üõ†Ô∏è –ó–∞–ø—É—Å–∫
docker-compose up --build

–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:

–í—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤ SearchInput –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã. –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤—Å–µ —Ç–æ–≤–∞—Ä—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.

page –∏ limit –∑–∞–¥–∞—é—Ç –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π –≤—ã–≤–æ–¥. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π limit ‚Äî 100.

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ (_score) –≤ Elasticsearch.